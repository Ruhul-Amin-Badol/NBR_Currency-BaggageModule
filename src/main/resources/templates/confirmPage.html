<div th:replace="~{layout/support}"></div>

<div class="container-fluid" style="background: white;">
    <div class="logo d-flex justify-content-center">
        <img src="/img/logo/nbr.png" alt="nbr_logo">

    </div>
    <div class="container">
        <div class="d-flex gap-2 py-3">
            <button type="button" class="btn btn-primary print-button" onclick="printPage()">Print</button>
        <a href="/baggagestart/show"><button type="button" class="btn btn-primary print-button" >Go Back</button></a>
        </div>
        <table>
            <tbody th:object="${reportShow}">
                <input type="hidden" id="reportShow" name="id" th:value="${reportShow['ID']}" />

                <tr>
                    <td><span><span class="fw-bold">Entry Point: </span><span th:text="${reportShow['entry_point']}"></span></span></td>
                 </tr>
 
                <tr>
                    <td><span class="fw-bold">Name of the Passenger: </span><span th:text="${reportShow['passenger_name']}"></span></td>
                </tr>


                <tr>
                    <td><span class="fw-bold">Payment Id: </span><span th:text="${reportShow['payment_id']}"></span></td>
                </tr>

                <tr>
                   <td><span><span class="fw-bold">Place of Issue: </span><span th:text="${reportShow['entry_point']}"></span></span></td>
                </tr>

                <tr>
                    <td><span class="fw-bold">Passport Number: </span><span th:text="${reportShow['passport_number']}"></span></td>
                </tr>
                <tr>
                    <td><span class="fw-bold">Passport Validity Date: </span><span th:text="${reportShow['passport_validity_date']}"></span></td>
                </tr>
                <tr>
                    <td><span class="fw-bold">Nationality: </span><span th:text="${reportShow['nationality']}"></span></td>
                </tr>
                <tr>
                    <td><span class="fw-bold">Country from where comming: </span><span th:text="${reportShow['previous_country']}"></span></td>
                </tr>
                <tr>
                    <td><span class="fw-bold">Date Of Arrival: </span><span th:text="${reportShow['dateofarrival']}"></span></td>
                </tr>
                <tr>
                    <td><span class="fw-bold">Flight No: </span><span th:text="${reportShow['flight_no']}"></span></td>
                </tr>
                <tr>
                    <td><span class="fw-bold">Mobile No: </span><span th:text="${reportShow['mobile_no']}"></span></td>
                </tr>
                <tr>
                    <td><span class="fw-bold">Email: </span><span th:text="${reportShow['email']}"></span></td>
                </tr>
                <!-- <tr> 
                    <td><span class="fw-bold">Accompanied: </span><span th:text="${reportShow['accom_no']}"></span></td>
                </tr>
                <tr>
                    <td><span class="fw-bold">Un-Accompanied: </span><span th:text="${reportShow['unaccom_no']}"></span></td>
                </tr> -->
                
            </tbody>
        </table>

        <!-- table 2nd start -->
        <table id="ajaxtable"
            class="table table-bordered table-striped mt-5">
            <thead style="background-color: rgba(96, 204, 69, 0.952);">
                <tr>
                   
                    <th scope="col">Product Name</th>
                    <th scope="col">Unit</th>
                    <th scope="col">Inchi(For Telivision)</th>
                    <th scope="col">Quantity</th>
                    <th scope="col">Value</th>
                    <!-- <th scope="col">Tax(%)</th>
                    <th scope="col">CD(%)</th>
                    <th scope="col">RD(%)</th>
                    <th scope="col">SD(%)</th>
                    <th scope="col">VAT(%)</th>
                    <th scope="col">AIT(%)</th>
                    <th scope="col">AT(%)</th> -->
                    <th scope="col">Tax Amount</th>
                
                </tr>
            </thead> 
            <tbody >

              <tr th:each="reportShow : ${showProduct}">
                    
                    <td th:text="${reportShow['item_name']}"></td>
                    <td th:text="${reportShow['unit_name']}"></td>
                    <td th:text="${reportShow['inchi']}"></td>
                    <td th:text="${reportShow['qty']}"></td>
                    <td th:text="${reportShow['value']}"></td>
                    <!-- <td th:text="${reportShow['tax_percentage']}"></td>

                    <td th:text="${reportShow['cd']}"></td>
                    <td th:text="${reportShow['rd']}"></td>
                    <td th:text="${reportShow['sd']}"></td>
                    <td th:text="${reportShow['vat']}"></td>
                    <td th:text="${reportShow['ait']}"></td>
                    <td th:text="${reportShow['at']}"></td> -->


                    <td class="tax-amount" th:text="${reportShow['tax_amount']}"></td>
                 
                </tr> 

                <tr>
                        <th colspan="5" class="text-end"> Total Paid</th>
                        <td >
                            <span id="totalTaxAmount"></span>
                        </td>
                    </td>
                    </tr>
                   
            </tbody>
        </table>


        <div class="container ">
            <div class="row mt-5">
              <div class="col-sm" >
                <p style="font-weight: bold;">[Signature of Customs Official]</p>

                <p>(Signature of Customs Official):</p>
                
                <p>[Date]</p>
              </div>
              <div class="col-sm">
               
              </div>
              <div class="col-sm text-end" >
                <p style="font-weight: bold;" th:text="${reportShow['passenger_name']}"></p>
                <p style="font-weight: bold;">[Signature of Declarant]</p>
                <p>Signature of Declarant:</p>
                <p><span th:text="${reportShow['dateofarrival']}"></p>

              </div>
            </div>
          </div>


     <div class="d-flex justify-content-center" id="qrcode">
        
    </div>
    <div class="d-flex justify-content-center">
        <div id="barcode-value" class="fw-bold"></div>
        <br>
        <br>
    </div>

     


    </div>
    <script>
     function qrcode() {
          console.log("fahim");
            // Get the current page's URL
            var currentURL = window.location.href;

            // Generate the QR code using an online service (qr.js)
            var qrCodeUrl = "https://api.qrserver.com/v1/create-qr-code/?data=" + encodeURIComponent(currentURL) + "&size=128x128";
            
            // Display the QR code image
            $("#qrcode").html('<img src="' + qrCodeUrl + '" alt="QR Code" />');
        };
function generateBarcode() {
    console.log("Fahim");
    // Get the value from the hidden input field
    var idValue = document.getElementById("reportShow").value*1000;

    // Define the element where you want to display the barcode
    var barcodeElement = document.getElementById("barcode");

    // Generate the barcode using JsBarcode
    JsBarcode(barcodeElement, idValue, {
        format: "CODE128", // Specify the barcode format you want to use
        displayValue: false, // Set to true if you want to display the value alongside the barcode
    });
    var barcodeValueElement = document.getElementById("barcode-value");
    barcodeValueElement.textContent = idValue;
}
        function redirectToHomePage() {
            
            // Get the id value from the hidden input field
            var id = document.getElementById("reportShow").value;
            var url = "/baggagestart/show?id=" + id;
            window.location.href = url;
        }

        function calculateTotalTaxAmount() {
            // Get all the tax amount elements using a class selector
            var taxAmountElements = document.querySelectorAll(".tax-amount");
    
            // Initialize a variable to store the total tax amount
            var totalTaxAmount = 0;
    
            // Iterate through each tax amount element
            taxAmountElements.forEach(function (element) {
                // Parse the text content of the element to a floating-point number
                var taxAmount = parseFloat(element.textContent);
    
                totalTaxAmount += taxAmount;
            });
    
            // Set the calculated total tax amount in the totalTaxAmount span
            document.getElementById("totalTaxAmount").textContent = totalTaxAmount.toFixed(2);
            generateBarcode();
        }
       function fahim(){
        console.log("Fahim");
       }
        // Call the function when the page loads
        window.addEventListener("load", calculateTotalTaxAmount);
        window.addEventListener("load", generateBarcode);


        function printPage() {
        // Hide the print buttons
        var printButtons = document.querySelectorAll(".print-button");
        for (var i = 0; i < printButtons.length; i++) {
            printButtons[i].style.display = "none";
        }

          // Add an event listener for the afterprint event
          window.addEventListener('afterprint', function () {
            // Show the print buttons when the print dialog is closed
            for (var i = 0; i < printButtons.length; i++) {
                printButtons[i].style.display = "block";
            }
        });

        // Print the content of the page
        window.print();
      
        
     
    }

    window.onload = qrcode;

    
 
    </script>
    

    <!-- table 2nd start -->

</div>

<div th:replace="~{layout/footer}"></div>